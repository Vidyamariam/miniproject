<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Add Product</title>
    <link
      rel="stylesheet"
      href="https://unpkg.com/cropperjs/dist/cropper.min.css"
    />

    <link rel="stylesheet" href="/stylesheets/admin/addProduct.css" />
  </head>

  <body>
    <div class="title">
      <h2>Add Product Form</h2>
    </div>
    <div class="main">
      <form
        action="/admin/addproduct"
        method="POST"
        enctype="multipart/form-data"
      >
        <label for="productName">Product Name:</label>
        <input type="text" id="productName" name="name" required />

        <label for="Category">Category:</label>
        <select id="Category" name="category">
          <option value="" disabled selected>Select Category</option>
          <% categories.forEach((category) => { %> <% if (category.isListed) {
          %>
          <option value="<%= category.categoryName %>">
            <%= category.categoryName %>
          </option>
          <% } %> <% }); %>
        </select>

        <label for="images">Images:</label>
        <input
          class="form-control"
          type="file"
          id="productImage"
          name="productImages"
          accept="image/*"
          multiple
          required
          onchange="previewImage(this)"
        />

        <!-- Image preview container -->
        <div id="imagePreviewContainer">
          <img id="imagePreview" src="#" alt="Image Preview" />
        </div>

        <!-- Cropper container -->
        <!-- <div>
          <label for="cropperContainer">Crop Image:</label>
          <div id="cropperContainer"></div> -->
        <!-- Button to trigger cropping -->
        <!-- <button type="button" onclick="cropImage()"></button>
        </div> -->

        <label for="description">Description:</label>
        <textarea id="description" name="description"></textarea>

        <label for="sizes">Sizes:</label>
        <select id="sizes" name="sizes" multiple>
          <option value="" disabled selected>Select the size</option>
          <option value="S">S</option>
          <option value="M">M</option>
          <option value="L">L</option>
        </select>

        <label for="price">Price:</label>

        <input type="number" id="price" name="price" />

        <label for="discount">Discount:</label>
        <input type="number" id="discount" name="discount" step="0.01" />

        <label for="stock">Stock:</label>
        <input type="number" id="stock" name="stock" step="1" />
        <br />

        <small style="color: orange"><%= locals.msg %></small>

        <div>
          <button type="submit">Submit</button>
          <button type="button" onclick="cancelForm()">Cancel</button>
        </div>
      </form>
    </div>

    <!--JS-->
    <!-- ... (your existing HTML) -->

    <script src="https://unpkg.com/cropperjs/dist/cropper.min.js"></script>

    <script>
      function previewImage(input) {
        var previewContainer = document.getElementById("imagePreviewContainer");

        // Clear previous previews
        previewContainer.innerHTML = "";

        // Check if files are selected
        if (input.files && input.files.length > 0) {
          for (let i = 0; i < input.files.length; i++) {
            // Create an image element for each file
            var reader = new FileReader();
            reader.onload = function (e) {
              var img = document.createElement("img");
              img.className = "preview-image";
              img.src = e.target.result;
              previewContainer.appendChild(img);
            };
            reader.readAsDataURL(input.files[i]);
          }

          // Display the preview container
          previewContainer.style.display = "block";
        } else {
          // Hide the preview container if no files are selected
          previewContainer.style.display = "none";
        }
      }

      function cancelForm() {
        // Add logic to handle cancel action
        alert("Form canceled");
      }

      // // Attach the previewImage function to the change event of the file input
      document
        .getElementById("productImage")
        .addEventListener("change", function () {
          previewImage(this);
        });
    </script>
  </body>
</html>
