<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Edit Product</title>
    <link rel="stylesheet" href="/stylesheets/admin/editProduct.css" />
  </head>
  <body>
    <div class="title">
      <h2>Edit Product Form</h2>
    </div>
    <div class="main">
      <form
        action="/admin/editproduct/<%=items._id%>"
        method="post"
        enctype="multipart/form-data"
        onsubmit="return validateForm()"
      >
        <label for="productName">Product Name:</label>
        <input
          type="text"
          id="productName"
          name="name"
          value="<%=items.name %>"
        />

        <label for="Category">Category:</label>
        <select id="Category" name="category">
          <% category.forEach((cat) => { %>
            <option <%= cat.categoryName === items.category ? 'selected' : '' %>><%= cat.categoryName %></option>
          <% }); %>
        </select>

        <label for="images">Images:</label>
        <input
          class="form-control"
          type="file"
          id="images"
          name="productImages"
          accept="image/*"
          multiple
          onchange="previewImages(this)"
        />

  <!-- Image preview container -->
  <div id="imagePreviewContainer">
    <!-- Existing images preview -->
    <% items.productImage.forEach((imageUrl) => { %>
      <img src="<%= imageUrl %>" alt="Product Image" />
      <input type="hidden" name="existingImages[]" value="<%= imageUrl %>" />
    <% }); %>
  </div>

        <label for="description">Description:</label>
        <textarea
          id="description"
          name="description"
        ><%= items.description %></textarea>
      
        <label for="price">Price:</label>
        <input
          type="number"
          id="price"
          name="price"
          value="<%= items.price %>"
        />

        <label for="discount">Discount:</label>
        <input
          type="number"
          id="discount"
          name="discount"
          step="0.01"
          value="<%= items.discount %>"
        />

        <label for="stock">Stock:</label>
        <input
          type="number"
          id="stock"
          name="stock"
          step="1"
          value="<%= items.stock %>"
        />

        <!-- Removed increase/decrease buttons for price and discount -->
        <div>
          <button type="submit">Submit</button>
          <button type="button" onclick="cancelForm()">Cancel</button>
        </div>
      </form>
    </div>

        <!-- Add this script at the end of your HTML body -->
   <!-- ... Your existing HTML code ... -->

<script>
  function cancelForm() {
    // Add logic to handle cancel action
    alert("Form canceled");
  }

  function previewImages(input) {
    var previewContainer = document.getElementById("imagePreviewContainer");

    for (var i = 0; i < input.files.length; i++) {
      var reader = new FileReader();
      reader.onload = function (e) {
        var img = document.createElement("img");
        img.src = e.target.result;
        previewContainer.appendChild(img);
      };
      reader.readAsDataURL(input.files[i]);
    }
  }

  document.addEventListener("DOMContentLoaded", function () {
    var form = document.querySelector("form");

    form.addEventListener("submit", function (event) {
      // Validation for Product Name
      var productNameInput = document.getElementById("productName");
      if (productNameInput.value.trim() === "") {
        alert("Product Name cannot be empty");
        event.preventDefault();
        return;
      } else if (!/^[a-zA-Z0-9\s]+$/.test(productNameInput.value)) {
        alert("Product Name can only contain letters, numbers, and spaces");
        event.preventDefault();
        return;
      }

      // Validation for Description
      var descriptionInput = document.getElementById("description");
      if (descriptionInput.value.trim() === "") {
        alert("Description cannot be empty");
        event.preventDefault();
        return;
      } 

      // Validation for Price
      var priceInput = document.getElementById("price");
      if (parseFloat(priceInput.value) < 0) {
        alert("Price cannot be negative");
        event.preventDefault();
        return;
      }

      // Validation for Discount
      var discountInput = document.getElementById("discount");
      if (parseFloat(discountInput.value) < 0) {
        alert("Discount cannot be negative");
        event.preventDefault();
        return;
      }

      // Validation for Stock
      var stockInput = document.getElementById("stock");
      if (parseInt(stockInput.value) < 0) {
        alert("Stock cannot be negative");
        event.preventDefault();
        return;
      }
    });
  });
</script>

<!-- ... Rest of your HTML code ... -->


  </body>
</html>
