<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Edit Product</title>
    <link rel="stylesheet" href="/stylesheets/admin/editProduct.css" />
  </head>
  <body>
    <div class="title">
      <h2>Edit Product Form</h2>
    </div>
    <div class="main">
      <form
        action="/admin/editproduct/<%=items._id%>"
        method="post"
        enctype="multipart/form-data"
      >
        <label for="productName">Product Name:</label>
        <input
          type="text"
          id="productName"
          name="name"
          value="<%=items.name %>"
        />

        <label for="Category">Category:</label>
        <select id="Category" name="category">
          <% category.forEach((cat) => { %>
            <option <%= cat.categoryName === items.category ? 'selected' : '' %>><%= cat.categoryName %></option>
          <% }); %>
        </select>

        <label for="images">Images:</label>
        <input
          class="form-control"
          type="file"
          id="images"
          name="productImage"
          accept="image/*"
          onchange="previewImage(this)"
        />

        <!-- Image preview container -->
        <div id="imagePreviewContainer">
          <img id="imagePreview" src="<%=items.productImage %>" alt="Product Image" />
        </div>

        <label for="description">Description:</label>
        <textarea
          id="description"
          name="description"
        ><%= items.description %></textarea>

      
        <label for="price">Price:</label>
        <input
          type="number"
          id="price"
          name="price"
          value="<%= items.price %>"
        />

        <label for="discount">Discount:</label>
        <input
          type="number"
          id="discount"
          name="discount"
          step="0.01"
          value="<%= items.discount %>"
        />

        <label for="stock">Stock:</label>
        <input
          type="number"
          id="stock"
          name="stock"
          step="1"
          value="<%= items.stock %>"
        />

        <!-- Removed increase/decrease buttons for price and discount -->
        <div>
          <button type="submit">Submit</button>
          <button type="button" onclick="cancelForm()">Cancel</button>
        </div>
      </form>
    </div>

    <script>
      function cancelForm() {
        // Add logic to handle cancel action
        alert("Form canceled");
      }

      function previewImage(input) {
        var previewImage = document.getElementById("imagePreview");
        var previewContainer = document.getElementById("imagePreviewContainer");

    // Clear previous previews
    previewContainer.innerHTML = "";

        if (input.files && input.files[0]) {
          var reader = new FileReader();

          reader.onload = function (e) {
            previewImage.src = e.target.result;
          };

          reader.readAsDataURL(input.files[0]);

          
      // Display the new image preview
      previewContainer.appendChild(previewImage);
        } else {
          // If no new image is selected, retain the existing product images
      <% items.productImage.forEach((imageUrl) => { %>
        var existingImage = '<%= imageUrl %>';
        var img = document.createElement("img");
        img.src = existingImage;
        previewContainer.appendChild(img);
      <% }); %>
        }
      }
    </script>
  </body>
</html>
