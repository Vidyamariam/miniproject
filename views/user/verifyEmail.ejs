<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title> 
    <link rel="stylesheet" href="/stylesheets/user/verifyEmail.css">

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    
    <!-- Add Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    />

    <!-- Add Bootstrap JS (jQuery and Popper.js are required) -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@300;400;500;700&display=swap" rel="stylesheet">

</head>
<body>

    <header>
        <div id="header-info">
          <!-- <p id="contactus">Contact Us</p> -->
          <img src="/img/siteLogo1.png" class="logo" />
          <h1 id="store-name">STEPUP SHOES</h1>
          <div class="nav-icons">
            <a id="favourite"><i class="fa fa-regular fa-heart fa-xl"></i></a>
            <a id="addtocart"><i class="fa fa-duotone fa-cart-shopping fa-xl"></i></a>
            
            <a style="color: black;" href="/login"  id="user"><i class="fa-solid fa-user fa-xl" ></i></a>
           
          </div>
          </div>
        </div>
  
        <nav id="nav-bar">
          <a href="">Home</a>
          <a href="">Running shoes</a>
          <a href="">Sneakers</a>
          <img src="" id="search-icon" />
        </nav>
      </header>
      <div class="title">
        <h2>Verify Email   </h2>
      </div>
      <% if (typeof message !== 'undefined') { %>
        <div class="Errormsg">
          <h3 ><%= message %></h3>
        </div>
      <% } %>

      <div class="main-content">

        <form action="/verifyemail" id="otp-form" method="post">
          <div class="input-field">
            <input type="number" name="n1" />
            <input type="number"  name="n2"   disabled/>
            <input type="number" name="n3"   disabled/>
            <input type="number" name="n4"   disabled/>
          </div>
          <button type="submit" class="btn btn-sm" class="active">Verify OTP</button>
          <br> 
        </form>
        <div id="otp-timer"></div>
         <a href="/resend">resend otp</a>    

      </div>

 <!--FOOTER SECTION-->
 <footer>
    <div class="footer-content">
      <div class="footer-logo">
        <img src="/img/siteLogo2.jpeg" class="logo" />
      </div>
      <h2>FOLLOW US</h2>
      <div class="social-icons">
        <div class="icon-div">
          <a href="#" class="icon"><i class="fa-brands fa-facebook fa-xl" style="color: #f1f3f3;"></i></a>
        </div>
        <div class="icon-div">
          <a href="#" class="icon"><i class="fa-brands fa-twitter fa-xl" style="color: #f1f3f3;"></i></a>
        </div>
         <div class="icon-div">
        <a href="#" class="icon"><i class="fa-brands fa-instagram fa-xl" style="color: #f1f3f3;"></i></i></a>
         </div>
         <div class="icon-div">
          <a href="#" class="icon"><i class="fa-brands fa-youtube fa-xl" style="color: #f1f3f3;"></i></a>
         </div>         
      </div>
      <ul class="footer-links">
        <li><a href="#">FAQS</a></li>
        <li><a href="#">About</a></li>
        <li><a href="#">Shippping and Delivery</a></li>
        <li><a href="#">Payments</a></li>
      </ul>
    </div>
    <p>&copy; 2024 Your Company. All rights reserved.</p>
  </footer>


<script>
    if (window.history.replaceState) {
        window.history.replaceState(null, null, window.location.href);
    }
</script> -->

    <script>
      document.addEventListener("DOMContentLoaded", function () {
  const inputs = document.querySelectorAll("input");
  const button = document.querySelector("button");
  const resendButton = document.getElementById("resendOTP");
  const emailInput = document.getElementById("resendEmail");

  inputs.forEach((input, index1) => {
    input.addEventListener("keyup", (e) => {
      const currentInput = input;
      const nextInput = input.nextElementSibling;
      const prevInput = input.previousElementSibling;

      if (currentInput.value.length > 1) {
        currentInput.value = "";
        return;
      }

      if (
        nextInput &&
        nextInput.hasAttribute("disabled") &&
        currentInput.value !== ""
      ) {
        nextInput.removeAttribute("disabled");
        nextInput.focus();
      }

      if (e.key === "Backspace") {
        inputs.forEach((input, index2) => {
          if (index1 <= index2 && prevInput) {
            input.setAttribute("disabled", true);
            input.value = "";
            prevInput.focus();
          }
        });
      }

      if (!inputs[3].disabled && inputs[3].value !== "") {
        button.classList.add("active");
        return;
      }
      button.classList.remove("active");
    });
  });


  resendButton.addEventListener("click", async () => {
      try {
        // Make an AJAX request to the backend to resend OTP
        const response = await fetch("/resendOtp", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ email: emailInput.value }), // Replace with the actual email
        });

        const responseData = await response.json();

        if (responseData.success) {
          // Handle success, e.g., show a message to the user
          console.log("OTP resent successfully");
        } else {
          // Handle failure, e.g., show an error message to the user
          console.error(responseData.error);
        }
      } catch (error) {
        console.error("An error occurred:", error);
      }
    });


});




////////////////////////////////////////

document.addEventListener("DOMContentLoaded", function () {
  // Set the initial time (in seconds)
  let timeLeft = 20; // Change this to your desired time

  // Function to update the timer display
  function updateTimer() {
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    document.getElementById("otp-timer").innerHTML = `Time Left: ${minutes}:${seconds}`;
  }

  // Function to decrement the timer and update the display
  function decrementTimer() {
    if (timeLeft > 0) {
      timeLeft--;
      updateTimer();
    } else {
      // Disable form submission or redirect to a different page when the timer reaches 0
      // You can customize this behavior based on your requirements
    }
  }

  // Call the updateTimer function initially
  updateTimer();

  // Set an interval to decrement the timer every second
  const timerInterval = setInterval(decrementTimer, 1000);

  // Optionally, you can stop the timer when the form is submitted or when the page is unloaded
  document.querySelector("form").addEventListener("submit", function () {
    clearInterval(timerInterval);
  });

  // Optionally, you can stop the timer when the user navigates away from the page
  window.addEventListener("beforeunload", function () {
    clearInterval(timerInterval);
  });
});

    </script>
</body>
</html>